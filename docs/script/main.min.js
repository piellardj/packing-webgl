!function(){"use strict";var e={377:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPicker=void 0;var n=i(697),r=[[new n.Color(29,62,94),new n.Color(44,98,154),new n.Color(68,174,163),new n.Color(243,214,99),new n.Color(233,86,64)],[new n.Color(14,61,4),new n.Color(23,122,8),new n.Color(183,58,69),new n.Color(238,213,157),new n.Color(209,135,52)],[new n.Color(8,29,60),new n.Color(31,99,159),new n.Color(60,157,199),new n.Color(175,240,255),new n.Color(235,184,133)],[new n.Color(141,28,11),new n.Color(164,75,38),new n.Color(229,171,84),new n.Color(127,164,161),new n.Color(91,125,123),new n.Color(31,54,54)],[new n.Color(38,38,38),new n.Color(76,76,76),new n.Color(114,114,114),new n.Color(153,153,153),new n.Color(191,191,191),new n.Color(220,220,220)],[new n.Color(252,17,147),new n.Color(23,0,81),new n.Color(106,39,197),new n.Color(33,168,159),new n.Color(133,224,191)],[new n.Color(167,206,160),new n.Color(95,154,121),new n.Color(55,82,83),new n.Color(218,172,115),new n.Color(244,219,142),new n.Color(155,143,100),new n.Color(170,109,75)],[new n.Color(255,0,0),new n.Color(135,0,255),new n.Color(46,0,255),new n.Color(0,161,255),new n.Color(0,255,46),new n.Color(238,255,0),new n.Color(255,123,0)]],o=function(){function e(){}return e.setPalette=function(t){t<0||t>=r.length?this.usePalette=!1:(this.usePalette=!0,e.palette=r[t])},e.getDisplayColor=function(t,i){return e.highContrastMode?i%2==+e.darkMode?n.Color.WHITE:n.Color.BLACK:t},e.getDifferentColorFromPalette=function(t){var i,n=e.palette.length;do{var r=Math.floor(n*Math.random());i=e.palette[r]}while(i===t);return i},e.highContrastMode=!1,e.darkMode=!1,e.usePalette=!1,e.palette=r[0],e}();t.ColorPicker=o},697:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0,"function"!=typeof String.prototype.padStart&&(String.prototype.padStart=function(e,t){if(this.length>e)return String(this);t||(t=" ");for(var i=Math.ceil((e-this.length)/t.length),n="",r=0;r<i;r++)n+=t;return n+this});var i=function(){function e(e,t,i){this.r=e,this.g=t,this.b=i}return e.random=function(){return new e(e.randomChannel(),e.randomChannel(),e.randomChannel())},e.prototype.toString=function(){if(!this.hexString){var e=this.r.toString(16).padStart(2,"0"),t=this.g.toString(16).padStart(2,"0"),i=this.b.toString(16).padStart(2,"0");this.hexString="#"+e+t+i}return this.hexString},e.randomChannel=function(){return Math.floor(256*Math.random())},e.BLACK=new e(0,0,0),e.WHITE=new e(255,255,255),e.GREEN=new e(0,255,0),e}();t.Color=i},642:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.mainDebugCollisions=void 0;var n=i(697),r=i(61),o=i(166),s=i(941),a=i(330),l=i(106),c=i(523),u=i(886),h={fixed:new l.PatternSquare,mobile:new l.PatternSquare},d={fixed:new s.PatternCircle,mobile:new s.PatternCircle},f={fixed:new a.PatternRectangle,mobile:new a.PatternRectangle},g={fixed:new c.PatternTriangle,mobile:new c.PatternTriangle};function p(e){return m({width:e,height:e})}function m(e){return[{from:{x:-.5*e.width,y:-.5*e.height},to:{x:.5*e.width,y:-.5*e.height}},{from:{x:.5*e.width,y:-.5*e.height},to:{x:.5*e.width,y:.5*e.height}},{from:{x:.5*e.width,y:.5*e.height},to:{x:-.5*e.width,y:.5*e.height}},{from:{x:-.5*e.width,y:.5*e.height},to:{x:-.5*e.width,y:-.5*e.height}}]}t.mainDebugCollisions=function(){var e=new u.PlotterCanvas2D,t=1;Page.Canvas.Observers.mouseWheel.push((function(e){t+=.1*e,t=Math.max(.2,Math.min(10,t))})),requestAnimationFrame((function i(){var s,a=r.Parameters.currentCollisionType,l=(s=r.Parameters.primitive)===r.EPrimitive.SQUARE?h:s===r.EPrimitive.CIRCLE?d:s===r.EPrimitive.RECTANGLE?f:g,c=Page.Canvas.getSize(),u=Math.min(c[0],c[1]),v=Page.Canvas.getMousePosition();l.mobile.center.x=(v[0]-.5)*c[0],l.mobile.center.y=(v[1]-.5)*c[1],l.fixed.center.x=0,l.fixed.center.y=0,l.fixed.size=.5*t*u;var P=function(){var t=r.Parameters.primitive;return t===r.EPrimitive.SQUARE?function(t){return e.drawSquares(t)}:t===r.EPrimitive.CIRCLE?function(t){return e.drawCircles(t)}:t===r.EPrimitive.RECTANGLE?function(t){return e.drawRectangles(t)}:function(t){return e.drawTriangles(t)}}();if(a===r.ECollisionTestType.PRIMITIVE){l.mobile.size=l.mobile.computeBiggestSizePossibleToAvoidItem(l.fixed,!0).size;var b=p(l.fixed.size);e.initialize(n.Color.BLACK),P([l.fixed,l.mobile]),e.drawLines(b,n.Color.GREEN),e.finalize()}else if(a===r.ECollisionTestType.POINT)l.mobile.size=l.mobile.computeBiggestSizePossibleToAvoidPoint({x:0,y:0}),b=p(.5),e.initialize(n.Color.BLACK),P([l.mobile]),e.drawLines(b,n.Color.GREEN),e.finalize();else{l.mobile.size=.2*t*u;var y={width:.5*c[0],height:.5*c[1]},_=l.mobile.computeVisibility(y);_===o.EVisibility.COVERS_VIEW?console.log("covers view"):_===o.EVisibility.OUT_OF_VIEW?console.log("out of view"):console.log("visible"),b=m(y),e.initialize(n.Color.BLACK),P([l.mobile]),e.drawLines(b,n.Color.GREEN),e.finalize()}requestAnimationFrame(i)}))}},852:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Engine=void 0;var s=i(697),a=i(377),l=i(61),c=i(166),u=i(941),h=i(330),d=i(106),f=i(523),g=i(247),p=o(i(8)),m=i(587);i(457);var v=function(){function e(){this.initializedItemsList=[],this.uninitializedItemsList=[],this.lastRecyclingTime=0,this.grid=new g.Grid,this.zoomCenter={x:0,y:0},this.currentBackgroundItem=null}return e.prototype.reset=function(){var e=l.Parameters.primitive;if(e===l.EPrimitive.SQUARE)this.createItem=function(){return new d.PatternSquare};else if(e===l.EPrimitive.CIRCLE)this.createItem=function(){return new u.PatternCircle};else if(e===l.EPrimitive.RECTANGLE)this.createItem=function(){return new h.PatternRectangle};else{if(e!==l.EPrimitive.TRIANGLE)throw new Error('Invalid primitive "'+e+".");this.createItem=function(){return new f.PatternTriangle}}this.initializedItemsList=[],this.uninitializedItemsList=[],this.currentPrimitive=e,this.currentBackgroundItem=null,this.zoomCenter.x=0,this.zoomCenter.y=0},e.prototype.setItemsCount=function(e){var t=this.initializedItemsList.length,i=t+this.uninitializedItemsList.length;if(e>i)for(var n=e-i,r=0;r<n;r++){var o=this.createItem();this.uninitializedItemsList.push(o)}else e<i&&(e>t?this.uninitializedItemsList.length=e-t:(this.uninitializedItemsList=[],this.initializedItemsList.length=e))},e.prototype.draw=function(t){e.DEFAULT_BACKGROUND_ITEM.color=l.Parameters.blackBackground?s.Color.BLACK:s.Color.WHITE,a.ColorPicker.darkMode=l.Parameters.blackBackground,a.ColorPicker.highContrastMode=l.Parameters.highContrast;var i=t.isReady;l.Parameters.isZooming||performance.now()-this.lastRecyclingTime>c.PatternBase.maxBlendingTime||(i=!1);var n,r=this.computeBackgroundColor();return t.initialize(r),n=l.Parameters.oneCellOnly?this.grid.getItemsFromCell(l.Parameters.cellX,l.Parameters.cellY):this.initializedItemsList,this.currentPrimitive===l.EPrimitive.SQUARE?t.drawSquares(n):this.currentPrimitive===l.EPrimitive.CIRCLE?t.drawCircles(n):this.currentPrimitive===l.EPrimitive.RECTANGLE?t.drawRectangles(n):this.currentPrimitive===l.EPrimitive.TRIANGLE&&t.drawTriangles(n),l.Parameters.showGrid&&this.grid.draw(t),t.finalize(),i},e.prototype.udpate=function(e,t){var i=this.uninitializedItemsList.length>0,n=this.initializedItemsList.length>0&&l.Parameters.isZooming,r=void 0===this.grid;if(!(i||n||r))return!1;var o=!1;p.timeSpentInReindex.start();var s=this.reindexItems(t);o=o||s,p.timeSpentInReindex.stop(),p.timeSpentInRecycle.start();var a=this.performRecycling(t);if(o=o||a,a&&(this.lastRecyclingTime=performance.now()),p.timeSpentInRecycle.stop(),p.timeSpentInZoom.start(),l.Parameters.isZooming){var c=this.initializedItemsList.length>0;this.performZoom(e,t),o=o||c}return p.timeSpentInZoom.stop(),o},e.prototype.reindexItems=function(e){var t=l.Parameters.cellSize;if(l.Parameters.adaptativeGrid){var i=l.Parameters.targetItemsPerGridCell,n=this.grid.itemsPerCell;t=this.grid.cellSize,n<i?t++:t--}return this.grid.reset(e,t,this.initializedItemsList)},e.prototype.performRecycling=function(e){for(var t=0,i=l.Parameters.allowOverlapping,n=1-l.Parameters.spacing,r=new m.NumberRange(l.Parameters.minSize,1e6),o=l.Parameters.maxTriesPerFrame,s=this.backgroundItem,a=o;this.uninitializedItemsList.length>0&&a>0;){var c=this.uninitializedItemsList.pop(),u=c.reset(e,this.grid,n,r,i,s,a);a-=u.nbTries,u.success?(this.initializedItemsList.push(c),this.grid.registerItem(c),t++):this.uninitializedItemsList.push(c)}var h=this.initializedItemsList.length+this.uninitializedItemsList.length,d=this.uninitializedItemsList.length,f=o-a;return p.registerRecyclingStats(h,t,d,f),this.grid.computeStatistics(),t>0},e.prototype.performZoom=function(e,t){this.updateZoomCenter(t);for(var i=[],n=1+e*l.Parameters.zoomSpeed,r=0,o=this.initializedItemsList;r<o.length;r++){var s=o[r];s.zoomIn(this.zoomCenter,n);var a;(a=s.size>c.PatternBase.MAX_SIZE?c.EVisibility.OUT_OF_VIEW:s.computeVisibility(t))===c.EVisibility.VISIBLE?i.push(s):(this.uninitializedItemsList.push(s),a===c.EVisibility.COVERS_VIEW&&(this.currentBackgroundItem={nestingLevel:s.nestingLevel%1e5,color:s.rawColor}))}this.initializedItemsList=i},e.prototype.computeBackgroundColor=function(){var e=this.backgroundItem;return a.ColorPicker.getDisplayColor(e.color,e.nestingLevel)},e.prototype.updateZoomCenter=function(e){if(Page.Canvas.isMouseDown()){var t=Page.Canvas.getMousePosition();this.zoomCenter.x=e.width*(t[0]-.5),this.zoomCenter.y=e.height*(t[1]-.5)}var i=.5*e.width,n=.5*e.height;this.zoomCenter.x<-i?this.zoomCenter.x=-i:this.zoomCenter.x>i&&(this.zoomCenter.x=i),this.zoomCenter.y<-n?this.zoomCenter.y=-n:this.zoomCenter.y>n&&(this.zoomCenter.y=n)},Object.defineProperty(e.prototype,"backgroundItem",{get:function(){return null!==this.currentBackgroundItem?this.currentBackgroundItem:e.DEFAULT_BACKGROUND_ITEM},enumerable:!1,configurable:!0}),e.DEFAULT_BACKGROUND_ITEM={nestingLevel:0,color:s.Color.BLACK},e}();t.Engine=v},753:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.gl=t.initGL=t.adjustSize=void 0,i(457);var n=null;t.gl=n,t.initGL=function(e){function i(e){Page.Demopage.setErrorMessage("webgl-support",e)}var r=Page.Canvas.getCanvas();if(t.gl=n=r.getContext("webgl",e),null==n){if(t.gl=n=r.getContext("experimental-webgl",e),null==n)return i("Your browser or device does not seem to support WebGL."),!1;i("Your browser or device only supports experimental WebGL.\nThe simulation may not run as expected.")}return n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.BLEND),n.clearColor(0,0,0,1),!0},t.adjustSize=function(e){void 0===e&&(e=!1);var t=e?window.devicePixelRatio:1,i=n.canvas,r=Math.floor(i.clientWidth*t),o=Math.floor(i.clientHeight*t);i.width===r&&i.height===o||(i.width=r,i.height=o)}},771:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GLResource=void 0;var i=function(){function e(e){this._gl=e}return e.prototype.gl=function(){return this._gl},e}();t.GLResource=i},748:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteShader=t.registerShader=t.getShader=t.buildShader=void 0;var s=i(753),a=i(490),l=o(i(71)),c={};function u(e,t){var i=2,n=0;function r(r){function o(t){return t.replace(/#INJECT\((.*)\)/gm,(function(t,i){return e.injected[i]?e.injected[i]:t}))}if(i--,r||n++,0===i){var c=null;if(0===n){var u=l.getSource(e.vertexFilename),h=l.getSource(e.fragmentFilename),d=o(u),f=o(h);c=new a.Shader(s.gl,d,f)}t(c)}}l.loadSource(e.vertexFilename,r),l.loadSource(e.fragmentFilename,r)}t.getShader=function(e){return c[e].shader},t.buildShader=u,t.registerShader=function(e,t,i){function n(e){for(var t=0,i=e.callbacks;t<i.length;t++)(0,i[t])(!e.failed,e.shader);e.callbacks=[]}if(void 0===c[e]){c[e]={callbacks:[i],failed:!1,infos:t,pending:!0,shader:null};var r=c[e];u(t,(function(e){r.pending=!1,r.failed=null===e,r.shader=e,n(r)}))}else{var o=c[e];!0===o.pending?o.callbacks.push(i):n(o)}},t.deleteShader=function(e){void 0!==c[e]&&(null!==c[e].shader&&c[e].shader.freeGLResources(),delete c[e])}},71:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.loadSource=t.getSource=void 0;var i={};t.loadSource=function(e,t){function n(e){for(var t=0,i=e.callbacks;t<i.length;t++)(0,i[t])(!e.failed);e.callbacks=[]}if(void 0===i[e]){i[e]={callbacks:[t],failed:!1,pending:!0,text:null};var r=i[e],o=new XMLHttpRequest;o.open("GET","./shaders/"+e,!0),o.onload=function(){4===o.readyState&&(r.pending=!1,200===o.status?(r.text=o.responseText,r.failed=!1):(console.error("Cannot load '"+e+"' shader source: "+o.statusText),r.failed=!0),n(r))},o.onerror=function(){console.error("Cannot load '"+e+"' shader source: "+o.statusText),r.pending=!1,r.failed=!0,n(r)},o.send(null)}else{var s=i[e];!0===s.pending?s.callbacks.push(t):(s.callbacks=[t],n(s))}},t.getSource=function(e){return i[e].text}},490:function(e,t,i){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.Shader=void 0;var o=i(771);function s(){alert("NOT IMPLEMENTED YET")}var a={35664:{str:"FLOAT_VEC2",binder:function(e,t,i){e.uniform2fv(t,i)}},35665:{str:"FLOAT_VEC3",binder:function(e,t,i){e.uniform3fv(t,i)}},35666:{str:"FLOAT_VEC4",binder:function(e,t,i){e.uniform4fv(t,i)}},35667:{str:"INT_VEC2",binder:function(e,t,i){e.uniform2iv(t,i)}},35668:{str:"INT_VEC3",binder:function(e,t,i){e.uniform3iv(t,i)}},35669:{str:"INT_VEC4",binder:function(e,t,i){e.uniform4iv(t,i)}},35670:{str:"BOOL",binder:function(e,t,i){e.uniform1i(t,+i)}},35671:{str:"BOOL_VEC2",binder:function(e,t,i){e.uniform2iv(t,i)}},35672:{str:"BOOL_VEC3",binder:function(e,t,i){e.uniform3iv(t,i)}},35673:{str:"BOOL_VEC4",binder:function(e,t,i){e.uniform4iv(t,i)}},35674:{str:"FLOAT_MAT2",binder:function(e,t,i){e.uniformMatrix2fv(t,!1,i)}},35675:{str:"FLOAT_MAT3",binder:function(e,t,i){e.uniformMatrix3fv(t,!1,i)}},35676:{str:"FLOAT_MAT4",binder:function(e,t,i){e.uniformMatrix4fv(t,!1,i)}},35678:{str:"SAMPLER_2D",binder:function(e,t,i,n){e.uniform1i(t,i),e.activeTexture(e["TEXTURE"+i]),e.bindTexture(e.TEXTURE_2D,n)}},35680:{str:"SAMPLER_CUBE",binder:function(e,t,i,n){e.uniform1i(t,i),e.activeTexture(e["TEXTURE"+i]),e.bindTexture(e.TEXTURE_CUBE_MAP,n)}},5120:{str:"BYTE",binder:s},5121:{str:"UNSIGNED_BYTE",binder:s},5122:{str:"SHORT",binder:s},5123:{str:"UNSIGNED_SHORT",binder:s},5124:{str:"INT",binder:function(e,t,i){Array.isArray(i),e.uniform1iv(t,i)}},5125:{str:"UNSIGNED_INT",binder:s},5126:{str:"FLOAT",binder:function(e,t,i){Array.isArray(i)?e.uniform1fv(t,i):e.uniform1f(t,i)}}},l=function(e){function t(t,i,n){var r=this;function o(e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.error(t.getShaderInfoLog(n)),t.deleteShader(n),null)}(r=e.call(this,t)||this).id=null,r.uCount=0,r.aCount=0;var s=o(t.VERTEX_SHADER,i),a=o(t.FRAGMENT_SHADER,n),l=t.createProgram();return t.attachShader(l,s),t.attachShader(l,a),t.linkProgram(l),t.getProgramParameter(l,t.LINK_STATUS)?(r.id=l,r.introspection()):(console.error(t.getProgramInfoLog(l)),t.deleteProgram(l)),r}return r(t,e),t.prototype.freeGLResources=function(){e.prototype.gl.call(this).deleteProgram(this.id),this.id=null},t.prototype.use=function(){e.prototype.gl.call(this).useProgram(this.id)},t.prototype.bindUniforms=function(){var t=this,i=e.prototype.gl.call(this),n=0;Object.keys(this.u).forEach((function(e){var r=t.u[e];if(null!==r.value)if(35678===r.type||35680===r.type){var o=n;a[r.type].binder(i,r.loc,o,r.value),n++}else a[r.type].binder(i,r.loc,r.value)}))},t.prototype.bindAttributes=function(){var e=this;Object.keys(this.a).forEach((function(t){var i=e.a[t];null!==i.VBO&&i.VBO.bind(i.loc)}))},t.prototype.bindUniformsAndAttributes=function(){this.bindUniforms(),this.bindAttributes()},t.prototype.introspection=function(){var t=e.prototype.gl.call(this);this.uCount=t.getProgramParameter(this.id,t.ACTIVE_UNIFORMS),this.u={};for(var i=0;i<this.uCount;i++){var n=t.getActiveUniform(this.id,i),r=n.name;this.u[r]={loc:t.getUniformLocation(this.id,r),size:n.size,type:n.type,value:null}}for(this.aCount=t.getProgramParameter(this.id,t.ACTIVE_ATTRIBUTES),this.a={},i=0;i<this.aCount;i++){var o=t.getActiveAttrib(this.id,i),s=o.name;this.a[s]={VBO:null,loc:t.getAttribLocation(this.id,s),size:o.size,type:o.type}}},t}(o.GLResource);t.Shader=l},62:function(e,t,i){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.VBO=void 0;var o,s=i(771);!function(e){e[e.DYNAMIC=0]="DYNAMIC",e[e.STATIC=1]="STATIC"}(o||(o={}));var a=function(e){function t(t,i,n,r,s){void 0===s&&(s=!0);var a=e.call(this,t)||this;return a.id=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,a.id),s?t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW):t.bufferData(t.ARRAY_BUFFER,i,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),a.size=n,a.type=r,a.normalize=!1,a.stride=0,a.offset=0,a.usage=s?o.STATIC:o.DYNAMIC,a}return r(t,e),t.createQuad=function(e,i,n,r,o){return new t(e,new Float32Array([i,n,r,n,i,o,r,o]),2,e.FLOAT,!0)},t.prototype.freeGLResources=function(){this.gl().deleteBuffer(this.id),this.id=null},t.prototype.bind=function(t){var i=e.prototype.gl.call(this);i.enableVertexAttribArray(t),i.bindBuffer(i.ARRAY_BUFFER,this.id),i.vertexAttribPointer(t,this.size,this.type,this.normalize,this.stride,this.offset)},t.prototype.bindInstanced=function(t,i,n){var r=e.prototype.gl.call(this);r.enableVertexAttribArray(t),r.bindBuffer(r.ARRAY_BUFFER,this.id),r.vertexAttribPointer(t,this.size,this.type,this.normalize,this.stride,this.offset),i.vertexAttribDivisorANGLE(t,n)},t.prototype.setData=function(t){var i=e.prototype.gl.call(this);i.bindBuffer(i.ARRAY_BUFFER,this.id),this.usage===o.STATIC?i.bufferData(i.ARRAY_BUFFER,t,i.STATIC_DRAW):i.bufferData(i.ARRAY_BUFFER,t,i.DYNAMIC_DRAW),i.bindBuffer(i.ARRAY_BUFFER,null)},t}(s.GLResource);t.VBO=a},633:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var s=i(377),a=i(642),l=i(852),c=i(61),u=i(886),h=i(139),d=i(174),f=o(i(8)),g=o(i(440));i(457),c.Parameters.isInCollisionsDebug?a.mainDebugCollisions():function(){var e=c.Parameters.isWebGLVersion?new h.PlotterCanvasWebGL:new u.PlotterCanvas2D,t=new l.Engine,i=!0;c.Parameters.addRedrawObserver((function(){return i=!0})),c.Parameters.addClearObserver((function(){t.reset(),i=!0})),c.Parameters.addDownloadObserver((function(){var i=new d.PlotterSVG(e.size);t.draw(i);var n=i.export();g.downloadTextFile("packing.svg",n)}));var n=0;f.initialize(),t.reset(),requestAnimationFrame((function r(o){f.timeSpentInMainLoop.start();var a=.001*(o-n);n=o;var l=1e3*c.Parameters.quantity;t.setItemsCount(l),s.ColorPicker.setPalette(c.Parameters.paletteId),f.timeSpentInUpdate.start();var u=t.udpate(a,e.size);if(i=i||u,f.timeSpentInUpdate.stop(),i){f.timeSpentInDraw.start();var h=t.draw(e);f.timeSpentInDraw.stop(),i=!h}f.timeSpentInMainLoop.stop(),f.registerFrame(),requestAnimationFrame(r)}))}()},457:function(){},61:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ECollisionTestType=t.EPrimitive=t.Parameters=void 0,i(457);var s=o(i(440)),a="primitive-tab-id",l="spacing-range-id",c="min-size-range-id",u="allow-overlapping-checkbox-id",h="quantity-range-id",d="background-tab-id",f="palette-picker-id",g="blending-checkbox-id",p="high-contrast-checkbox-id",m="indicators-checkbox-id",v="instancing-checkbox-id",P="adaptative-grid-checkbox-id",b="target-items-per-gridcell-checkbox-id",y="cell-size-range-id",_="one-cell-only-checkbox-id",x="show-grid-checkbox-id",C="cell-x-range-id",I="cell-y-range-id",S=[];function w(){for(var e=0,t=S;e<t.length;e++)(0,t[e])()}Page.Canvas.Observers.canvasResize.push(w),Page.Checkbox.addObserver(u,w),Page.Tabs.addObserver(d,w),Page.Checkbox.addObserver(p,w),Page.Checkbox.addObserver(_,w),Page.Checkbox.addObserver(x,w),Page.Checkbox.addObserver(v,w),Page.Range.addObserver(h,w),Page.Range.addObserver(C,w),Page.Range.addObserver(I,w);var O,z,T=[];function E(){for(var e=0,t=T;e<t.length;e++)(0,t[e])()}Page.Button.addObserver("reset-button-id",E),Page.Tabs.addObserver(a,E),Page.Range.addObserver(l,(function(){V.isZooming||E()})),Page.Range.addObserver(c,(function(){V.isZooming||E()})),Page.Picker.addObserver(f,(function(){V.isZooming||E()})),function(e){e.SQUARE="square",e.CIRCLE="circle",e.RECTANGLE="rectangle",e.TRIANGLE="triangle"}(O||(O={})),t.EPrimitive=O,function(e){e.PRIMITIVE="primitive",e.POINT="point",e.VISIBILITY="visbility"}(z||(z={})),t.ECollisionTestType=z;var A="1"===s.getQueryStringValue("debug"),R="1"===s.getQueryStringValue("debug-collisions");Page.Sections.setVisibility("display-section",!R),Page.Sections.setVisibility("debug-section",A&&!R),Page.Sections.setVisibility("debug-collisions-section",A&&R),Page.Canvas.setIndicatorVisibility("main-loop-time",A),Page.Canvas.setIndicatorVisibility("draw-time",A),Page.Canvas.setIndicatorVisibility("update-time",A),Page.Canvas.setIndicatorVisibility("update-reindex-time",A),Page.Canvas.setIndicatorVisibility("update-recycle-time",A),Page.Canvas.setIndicatorVisibility("update-zoom-time",A),Page.Canvas.setIndicatorVisibility("items-reclycled-count",A),Page.Canvas.setIndicatorVisibility("items-pending-recycling-count",A),Page.Canvas.setIndicatorVisibility("items-recycling-tries-count",A),Page.Canvas.setIndicatorVisibility("grid-size",A),Page.Canvas.setIndicatorVisibility("grid-cell-size",A),Page.Canvas.setIndicatorVisibility("grid-items-per-cell",A),A?Page.Checkbox.setChecked(m,!0):(Page.Checkbox.setChecked(_,!1),Page.Checkbox.setChecked(x,!1));var B="0"!==s.getQueryStringValue("webgl");function L(){var e=!R&&Page.Checkbox.isChecked(m);Page.Canvas.setIndicatorsVisibility(e)}function M(){var e=Page.Checkbox.isChecked(P);Page.Controls.setVisibility(b,e),Page.Controls.setVisibility(y,!e)}B||(Page.Checkbox.setChecked(g,!1),Page.Controls.setVisibility(g,!1),Page.Controls.setVisibility(v,!1)),Page.Checkbox.addObserver(m,L),L(),Page.Checkbox.addObserver(P,M),M(),Page.Button.addObserver("debug-collisions-button-id",(function(){window.location.href=window.location.href+"&debug-collisions=1"}));var V=function(){function e(){}return Object.defineProperty(e,"quantity",{get:function(){return Page.Range.getValue(h)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"spacing",{get:function(){return Page.Range.getValue(l)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"minSize",{get:function(){return Page.Range.getValue(c)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"allowOverlapping",{get:function(){return Page.Checkbox.isChecked(u)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"primitive",{get:function(){return Page.Tabs.getValues(a)[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"zoomSpeed",{get:function(){return Page.Range.getValue("zoom-speed-range-id")},enumerable:!1,configurable:!0}),Object.defineProperty(e,"isZooming",{get:function(){return Math.abs(e.zoomSpeed)>.001},enumerable:!1,configurable:!0}),Object.defineProperty(e,"blackBackground",{get:function(){return"dark"===Page.Tabs.getValues(d)[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"blending",{get:function(){return Page.Checkbox.isChecked(g)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"paletteId",{get:function(){return+Page.Picker.getValue(f)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"highContrast",{get:function(){return Page.Checkbox.isChecked(p)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"isInDebug",{get:function(){return A},enumerable:!1,configurable:!0}),Object.defineProperty(e,"isInCollisionsDebug",{get:function(){return R},enumerable:!1,configurable:!0}),Object.defineProperty(e,"isWebGLVersion",{get:function(){return B},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxTriesPerFrame",{get:function(){return 100*Page.Range.getValue("max-tries-per-frame-range-id")},enumerable:!1,configurable:!0}),Object.defineProperty(e,"adaptativeGrid",{get:function(){return Page.Checkbox.isChecked(P)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"targetItemsPerGridCell",{get:function(){return Page.Range.getValue(b)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cellSize",{get:function(){return Page.Range.getValue(y)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"oneCellOnly",{get:function(){return Page.Checkbox.isChecked(_)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"showGrid",{get:function(){return Page.Checkbox.isChecked(x)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cellX",{get:function(){return Page.Range.getValue(C)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cellY",{get:function(){return Page.Range.getValue(I)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"useInstancing",{get:function(){return Page.Checkbox.isChecked(v)},enumerable:!1,configurable:!0}),e.disallowInstancing=function(){Page.Checkbox.setChecked(v,!1),Page.Controls.setVisibility(v,!1)},Object.defineProperty(e,"currentCollisionType",{get:function(){return Page.Tabs.getValues("collision-test-type-tab-id")[0]},enumerable:!1,configurable:!0}),e.addRedrawObserver=function(e){S.push(e)},e.addClearObserver=function(e){T.push(e)},e.addDownloadObserver=function(e){Page.FileControl.addDownloadObserver("result-download-id",e)},e}();t.Parameters=V},166:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.EVisibility=t.PatternBase=void 0;var n,r=i(697),o=i(377),s=i(61),a={x:0,y:0},l=1;!function(e){e[e.VISIBLE=0]="VISIBLE",e[e.OUT_OF_VIEW=1]="OUT_OF_VIEW",e[e.COVERS_VIEW=2]="COVERS_VIEW"}(n||(n={})),t.EVisibility=n;var c=function(){function e(){this.center={x:0,y:0},this.size=0,this.nestingLevel=0,this.rawColor=r.Color.random(),this.lastTestId=0}return Object.defineProperty(e,"maxBlendingTime",{get:function(){return s.Parameters.blending?500/(1+s.Parameters.zoomSpeed):0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return o.ColorPicker.getDisplayColor(this.rawColor,this.nestingLevel)},enumerable:!1,configurable:!0}),e.prototype.zoomIn=function(e,t){this.center.x=(this.center.x-e.x)*t+e.x,this.center.y=(this.center.y-e.y)*t+e.y,this.size*=t},e.prototype.reset=function(e,t,i,n,r,s,a){for(var l={nbTries:0,success:!1};l.nbTries<a&&!l.success;){this.randomizePosition(e),this.parentItem=null;var c=i*this.computeBiggestSizePossible(t,r);if(n.isInRange(c)){this.size=2*Math.floor(.5*c),this.initializationTime=performance.now(),l.success=!0;var u=null!==this.parentItem?this.parentItem.nestingLevel:s.nestingLevel;if(this.nestingLevel=u+1,o.ColorPicker.usePalette){var h=null!==this.parentItem?this.parentItem.rawColor:s.color;this.rawColor=o.ColorPicker.getDifferentColorFromPalette(h)}}l.nbTries++}return l},e.prototype.computeOpacity=function(t,i){if(this.size>e.MAX_SIZE_LOWER){var n=(this.size-e.MAX_SIZE_LOWER)/e.MAX_SIZE_GAP;return n>1?0:1-n}var r=t-this.initializationTime;return r>i?1:r/i},e.prototype.computeBiggestSizePossible=function(e,t){var i=l=(l+1)%999999999999,n=this.computeBiggestSizePossibleToAvoidPoint(a),r=e.getDistanceToClosestBorder(this.center),o=e.getCellId(this.center),s=e.getItemsFromCell(o.x,o.y),c=this.computeBiggestSizePossibleToAvoidItems(s,t,i);if((n=Math.min(n,c))>=r){var u={x:this.center.x-.5*n,y:this.center.y-.5*n},h={x:this.center.x+.5*n,y:this.center.y+.5*n},d=e.getCellId(u),f=e.getCellId(h),g=e.getItemsFromCellsGroup(d.x,d.y,f.x,f.y),p=this.computeBiggestSizePossibleToAvoidItems(g,t,i);n=Math.min(n,p)}return n},e.prototype.computeBiggestSizePossibleToAvoidItems=function(e,t,i){for(var n=1e5,r=0,o=e;r<o.length;r++){var s=o[r];if(s!==this&&s.lastTestId!==i){var a=this.computeBiggestSizePossibleToAvoidItem(s,t);a.size<n&&(n=a.size,a.isInside&&(this.parentItem=s)),s.lastTestId=i}}return n},e.prototype.randomizePosition=function(e){this.center.x=Math.round(e.width*(Math.random()-.5)),this.center.y=Math.round(e.height*(Math.random()-.5))},e.MAX_SIZE=1e6,e.MAX_SIZE_LOWER=.75*e.MAX_SIZE,e.MAX_SIZE_GAP=e.MAX_SIZE-e.MAX_SIZE_LOWER,e}();t.PatternBase=c},941:function(e,t,i){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.PatternCircle=void 0;var o=i(166),s=function(e){function t(){return e.call(this)||this}return r(t,e),t.prototype.computeBiggestSizePossibleToAvoidPoint=function(e){var t=e.x-this.center.x,i=e.y-this.center.y;return 2*Math.sqrt(t*t+i*i)},t.prototype.computeBiggestSizePossibleToAvoidItem=function(e,t){var i={size:0,isInside:!1},n=this.center.x-e.center.x,r=this.center.y-e.center.y,o=Math.sqrt(n*n+r*r);return o<=e.radius?t&&(i.size=2*(e.radius-o),i.isInside=!0):i.size=2*(o-e.radius),i},t.prototype.computeVisibility=function(e){var t=.5*e.width,i=.5*e.height,n=Math.abs(this.center.x),r=Math.abs(this.center.y),s=n+t,a=r+i,l=this.radius;return l*l>s*s+a*a?o.EVisibility.COVERS_VIEW:n-l<t&&r-l<i?o.EVisibility.VISIBLE:o.EVisibility.OUT_OF_VIEW},Object.defineProperty(t.prototype,"radius",{get:function(){return.5*this.size},enumerable:!1,configurable:!0}),t}(o.PatternBase);t.PatternCircle=s},330:function(e,t,i){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.PatternRectangle=void 0;var o=i(166),s=function(e){function t(){var t=e.call(this)||this;return t.aspectRatio=1+.5*(2*Math.random()-1),t.aspectRatio>=1?(t.baseWidth=1,t.baseHeight=1/t.aspectRatio):(t.baseWidth=t.aspectRatio,t.baseHeight=1),t}return r(t,e),t.prototype.computeBiggestSizePossibleToAvoidPoint=function(e){var t=e.x-this.center.x,i=e.y-this.center.y,n=Math.abs(t)/this.baseWidth,r=Math.abs(i)/this.baseHeight;return 2*Math.max(n,r)},t.prototype.computeBiggestSizePossibleToAvoidItem=function(e,t){var i={size:0,isInside:!1},n=Math.abs(this.center.x-e.center.x),r=Math.abs(this.center.y-e.center.y),o=.5*e.width,s=.5*e.height;return n<o?r<s?t&&(i.size=2*Math.min((o-n)/this.baseWidth,(s-r)/this.baseHeight),i.isInside=!0):i.size=2*(r-s)/this.baseHeight:i.size=r<s?2*(n-o)/this.baseWidth:2*Math.max((n-o)/this.baseWidth,(r-s)/this.baseHeight),i},t.prototype.computeVisibility=function(e){var t=.5*e.width,i=.5*e.height,n=Math.abs(this.center.x),r=Math.abs(this.center.y),s=.5*this.size*this.baseWidth,a=.5*this.size*this.baseHeight;return n+t<s&&r+i<a?o.EVisibility.COVERS_VIEW:n-s<t&&r-a<i?o.EVisibility.VISIBLE:o.EVisibility.OUT_OF_VIEW},Object.defineProperty(t.prototype,"width",{get:function(){return this.size*this.baseWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.size*this.baseHeight},enumerable:!1,configurable:!0}),t}(o.PatternBase);t.PatternRectangle=s},106:function(e,t,i){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.PatternSquare=void 0;var o=i(166),s=function(e){function t(){return e.call(this)||this}return r(t,e),t.prototype.computeBiggestSizePossibleToAvoidPoint=function(e){var t=e.x-this.center.x,i=e.y-this.center.y,n=Math.abs(t),r=Math.abs(i);return 2*Math.max(n,r)},t.prototype.computeBiggestSizePossibleToAvoidItem=function(e,t){var i={size:0,isInside:!1},n=Math.abs(this.center.x-e.center.x),r=Math.abs(this.center.y-e.center.y),o=.5*e.sideLength;return n<o?r<o?t&&(i.size=2*Math.min(o-n,o-r),i.isInside=!0):i.size=2*(r-o):i.size=r<o?2*(n-o):2*Math.max(n-o,r-o),i},t.prototype.computeVisibility=function(e){var t=.5*e.width,i=.5*e.height,n=Math.abs(this.center.x),r=Math.abs(this.center.y),s=.5*this.size;return n+t<s&&r+i<s?o.EVisibility.COVERS_VIEW:n-s<t&&r-s<i?o.EVisibility.VISIBLE:o.EVisibility.OUT_OF_VIEW},Object.defineProperty(t.prototype,"sideLength",{get:function(){return this.size},enumerable:!1,configurable:!0}),t}(o.PatternBase);t.PatternSquare=s},523:function(e,t,i){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.PatternTriangle=void 0;var o=i(166);function s(e,t,i){return{x:e.x*t-e.y*i,y:e.x*i+e.y*t}}function a(e,t,i){var n=i.y*t.x-t.y*i.x;if(0!==n){var r=1/n,o=(i.x*e.y-i.y*e.x)*r;if(0<=o&&o<=1)return(t.x*e.y-t.y*e.x)*r}return-1}var l=1e8;function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=l,n=0,r=e;n<r.length;n++){var o=r[n];o>=0&&o<i&&(i=o)}return i===l?-1:i}var u=function(e){function t(){var i=e.call(this)||this;i.angle=2*Math.PI*Math.random();var n=Math.cos(i.angle),r=Math.sin(i.angle);return i.P1=s(t.baseP1,n,r),i.P2=s(t.baseP2,n,r),i.P3=s(t.baseP3,n,r),i.P1_TO_P2={x:i.P2.x-i.P1.x,y:i.P2.y-i.P1.y},i.P2_TO_P3={x:i.P3.x-i.P2.x,y:i.P3.y-i.P2.y},i.P3_TO_P1={x:i.P1.x-i.P3.x,y:i.P1.y-i.P3.y},i}return r(t,e),t.prototype.computeBiggestSizePossibleToAvoidPoint=function(e){if(e.x===this.center.x&&e.y===this.center.y)return 0;var t={x:e.x-this.center.x,y:e.y-this.center.y},i=a(this.P1,this.P1_TO_P2,t);return i<0&&(i=a(this.P2,this.P2_TO_P3,t))<0&&(i=a(this.P3,this.P3_TO_P1,t)),i>0?1/i:0},t.prototype.computeBiggestSizePossibleToAvoidItem=function(e,t){var i={size:0,isInside:!1};if(e.isPointInside(this.center.x,this.center.y)){if(!t)return i;i.isInside=!0}var n,r,o={x:e.center.x+e.P1.x*e.size-this.center.x,y:e.center.y+e.P1.y*e.size-this.center.y},s={x:e.center.x+e.P2.x*e.size-this.center.x,y:e.center.y+e.P2.y*e.size-this.center.y},l={x:e.center.x+e.P3.x*e.size-this.center.x,y:e.center.y+e.P3.y*e.size-this.center.y},u={x:e.P1_TO_P2.x*e.size,y:e.P1_TO_P2.y*e.size},h={x:e.P2_TO_P3.x*e.size,y:e.P2_TO_P3.y*e.size},d={x:e.P3_TO_P1.x*e.size,y:e.P3_TO_P1.y*e.size};n=c(a(o,u,this.P1),a(s,h,this.P1),a(l,d,this.P1),a(o,u,this.P2),a(s,h,this.P2),a(l,d,this.P2),a(o,u,this.P3),a(s,h,this.P3),a(l,d,this.P3));var f=a(this.P1,this.P1_TO_P2,o),g=a(this.P2,this.P2_TO_P3,o),p=a(this.P3,this.P3_TO_P1,o),m=a(this.P1,this.P1_TO_P2,s),v=a(this.P2,this.P2_TO_P3,s),P=a(this.P3,this.P3_TO_P1,s),b=a(this.P1,this.P1_TO_P2,l),y=a(this.P2,this.P2_TO_P3,l),_=a(this.P3,this.P3_TO_P1,l),x=Math.max(f,g,p,m,v,P,b,y,_);return r=0!==x?1/x:-1,i.size=c(n,r),i},t.prototype.computeVisibility=function(e){var t=.5*e.width,i=.5*e.height,n=Math.abs(this.center.x),r=Math.abs(this.center.y),s=.5*this.size;return this.isPointInside(-t,-i)&&this.isPointInside(t,-i)&&this.isPointInside(-t,i)&&this.isPointInside(t,i)?o.EVisibility.COVERS_VIEW:n-s<t&&r-s<i?o.EVisibility.VISIBLE:o.EVisibility.OUT_OF_VIEW},t.prototype.isPointInside=function(e,t){e=(e-this.center.x)/this.size,t=(t-this.center.y)/this.size;var i=this.P1_TO_P2.x*(t-this.P2.y)-(e-this.P2.x)*this.P1_TO_P2.y,n=this.P2_TO_P3.x*(t-this.P3.y)-(e-this.P3.x)*this.P2_TO_P3.y,r=this.P3_TO_P1.x*(t-this.P1.y)-(e-this.P1.x)*this.P3_TO_P1.y;return i<=0&&n<=0&&r<=0||i>0&&n>0&&r>0},t.baseP1={x:0,y:-.5},t.baseP2={x:.5*Math.cos(7*Math.PI/6),y:-.5*Math.sin(7*Math.PI/6)},t.baseP3={x:-.5*Math.cos(7*Math.PI/6),y:-.5*Math.sin(7*Math.PI/6)},t}(o.PatternBase);t.PatternTriangle=u},792:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PlotterBase=void 0;t.PlotterBase=function(){}},886:function(e,t,i){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.PlotterCanvas2D=void 0,i(457);var o=function(e){function t(){var t=e.call(this)||this;return t.context=t.canvas.getContext("2d",{alpha:!1}),t}return r(t,e),Object.defineProperty(t.prototype,"isReady",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.clearCanvas=function(e){this.context.fillStyle=e.toString(),this.context.fillRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.finalize=function(){},t.prototype.drawSquares=function(e){for(var t=.5*this._size.width,i=.5*this._size.height,n=0,r=e;n<r.length;n++){var o=r[n],s=o.center.x+t,a=o.center.y+i,l=.5*o.size;this.context.fillStyle=o.color.toString(),this.context.fillRect(s-l,a-l,o.size,o.size)}},t.prototype.drawCircles=function(e){for(var t=.5*this._size.width,i=.5*this._size.height,n=2*Math.PI,r=0,o=e;r<o.length;r++){var s=o[r],a=s.center.x+t,l=s.center.y+i;this.context.fillStyle=s.color.toString(),this.context.beginPath(),this.context.arc(a,l,s.radius,0,n),this.context.fill(),this.context.closePath()}},t.prototype.drawRectangles=function(e){for(var t=.5*this._size.width,i=.5*this._size.height,n=0,r=e;n<r.length;n++){var o=r[n],s=o.center.x+t,a=o.center.y+i;this.context.fillStyle=o.color.toString(),this.context.fillRect(s-.5*o.width,a-.5*o.height,o.width,o.height)}},t.prototype.drawTriangles=function(e){for(var t=.5*this._size.width,i=.5*this._size.height,n=0,r=e;n<r.length;n++){var o=r[n],s=o.center.x+t,a=o.center.y+i;this.context.fillStyle=o.color.toString(),this.context.beginPath(),this.context.moveTo(s+o.P1.x*o.size,a+o.P1.y*o.size),this.context.lineTo(s+o.P2.x*o.size,a+o.P2.y*o.size),this.context.lineTo(s+o.P3.x*o.size,a+o.P3.y*o.size),this.context.fill(),this.context.closePath()}},t.prototype.drawLines=function(e,t){this.context.fillStyle="none",this.context.strokeStyle=t.toString(),this.context.lineWidth=1,this.context.beginPath();for(var i=.5*this._size.width,n=.5*this._size.height,r=0,o=e;r<o.length;r++){var s=o[r];this.context.moveTo(s.from.x+i,s.from.y+n),this.context.lineTo(s.to.x+i,s.to.y+n)}this.context.stroke(),this.context.closePath(),this.context.strokeStyle="none"},t}(i(643).PlotterCanvasBase);t.PlotterCanvas2D=o},643:function(e,t,i){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.PlotterCanvasBase=void 0;var o=i(792);i(457);var s=function(e){function t(){var t,i=e.call(this)||this;return i.canvas=Page.Canvas.getCanvas(),i.cssPixel=null!==(t=window.devicePixelRatio)&&void 0!==t?t:1,i.resizeCanvas(),i}return r(t,e),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){this.resizeCanvas(),this.clearCanvas(e)},t.prototype.resizeCanvas=function(){var e=Math.floor(this.cssPixel*this.canvas.clientWidth),t=Math.floor(this.cssPixel*this.canvas.clientHeight);this.canvas.width===e&&this.canvas.height===t||(this.canvas.width=e,this.canvas.height=t),this._size={width:this.canvas.width,height:this.canvas.height}},t}(o.PlotterBase);t.PlotterCanvasBase=s},139:function(e,t,i){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&o(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PlotterCanvasWebGL=void 0;var l=i(753),c=a(i(748)),u=i(62),h=i(61),d=i(166),f=i(523),g=a(i(8)),p=i(643);i(457);var m=[-.5,.5,-.5,-.5,.5,.5,.5,-.5],v=[f.PatternTriangle.baseP1.x,f.PatternTriangle.baseP1.y,f.PatternTriangle.baseP2.x,f.PatternTriangle.baseP2.y,f.PatternTriangle.baseP3.x,f.PatternTriangle.baseP3.y],P=function(e){function t(){var t=e.call(this)||this;if(!l.initGL())throw new Error("Failed to initialize WebGL.");console.log('Max point size supported by WebGL: "'+l.gl.ALIASED_POINT_SIZE_RANGE+'" pixels.'),t.needToResetInstancingDivision=!1;if(t.instancingExt=l.gl.getExtension("ANGLE_instanced_arrays"),null===t.instancingExt){var i='Your device does not support the "ANGLE_instanced_arrays" WebGL extension. Using the fallback mode with GL_POINTS, which might cause visual artifacts.';Page.Demopage.setErrorMessage("webgl-instanced",i),console.log(i),h.Parameters.disallowInstancing()}else console.log('Using the "ANGLE_instanced_arrays" WebGL extension.');t.blending=!1,t.enableBlending=!0,t.linesBuffer=new Float32Array([]),t.linesVBO=new u.VBO(l.gl,new Float32Array(t.linesBuffer),2,l.gl.FLOAT,!1),t.statesBuffer=new Float32Array([]),t.statesVBO=new u.VBO(l.gl,t.statesBuffer,4,l.gl.FLOAT,!1),t.colorsBuffer=new Float32Array([]),t.colorsVBO=new u.VBO(l.gl,t.colorsBuffer,4,l.gl.FLOAT,!1);var n=m.concat(v);return t.geometryVBO=new u.VBO(l.gl,new Float32Array(n),2,l.gl.FLOAT,!0),t.linesShader=null,t.squaresShader=null,t.circlesShader=null,t.rectanglesShader=null,t.trianglesShader=null,t.loadAndBuildShader("point/lines.vert","point/lines.frag","lines",(function(e){return t.linesShader=e})),t.loadAndBuildShader("point/items.vert","point/squares.frag","squares",(function(e){return t.squaresShader=e})),t.loadAndBuildShader("point/items.vert","point/circles.frag","circles",(function(e){return t.circlesShader=e})),t.loadAndBuildShader("point/rectangles.vert","point/rectangles.frag","rectangles",(function(e){return t.rectanglesShader=e})),t.loadAndBuildShader("point/triangles.vert","point/triangles.frag","triangles",(function(e){return t.trianglesShader=e})),t.squaresInstancedShader=null,t.circlesInstancedShader=null,t.rectanglesInstancedShader=null,t.trianglesInstancedShader=null,t.supportsInstancing&&(t.loadAndBuildShader("instanced/simpleGeometry.vert","instanced/fillColor.frag","instanced squares",(function(e){return t.squaresInstancedShader=e})),t.loadAndBuildShader("instanced/circles.vert","instanced/circles.frag","instanced squares",(function(e){return t.circlesInstancedShader=e})),t.loadAndBuildShader("instanced/rectangles.vert","instanced/fillColor.frag","instanced circles",(function(e){return t.rectanglesInstancedShader=e})),t.loadAndBuildShader("instanced/triangles.vert","instanced/fillColor.frag","instanced triangles",(function(e){return t.trianglesInstancedShader=e}))),t}return r(t,e),Object.defineProperty(t.prototype,"isReady",{get:function(){return null!==this.linesShader&&null!==this.squaresShader&&null!==this.circlesShader&&null!==this.rectanglesShader&&null!==this.trianglesShader&&null!==this.squaresInstancedShader&&null!==this.circlesInstancedShader&&null!==this.rectanglesInstancedShader&&null!==this.trianglesInstancedShader},enumerable:!1,configurable:!0}),t.prototype.clearCanvas=function(e){l.gl.clearColor(e.r/255,e.g/255,e.b/255,1),l.gl.clear(l.gl.COLOR_BUFFER_BIT)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),l.gl.viewport(0,0,this._size.width,this._size.height)},t.prototype.finalize=function(){},t.prototype.drawSquares=function(e){this.drawPrimitives(this.squaresShader,this.squaresInstancedShader,e,h.EPrimitive.SQUARE)},t.prototype.drawCircles=function(e){this.drawPrimitives(this.circlesShader,this.circlesInstancedShader,e,h.EPrimitive.CIRCLE)},t.prototype.drawRectangles=function(e){this.drawPrimitives(this.rectanglesShader,this.rectanglesInstancedShader,e,h.EPrimitive.RECTANGLE,(function(e){return e.aspectRatio}))},t.prototype.drawTriangles=function(e){this.drawPrimitives(this.trianglesShader,this.trianglesInstancedShader,e,h.EPrimitive.TRIANGLE,(function(e){return e.angle}))},t.prototype.drawLines=function(e,t){var i=e.length;if(null!==this.linesShader&&i>=1){var n=4*i;this.linesBuffer.length!==n&&(this.linesBuffer=new Float32Array(n));for(var r=0;r<i;r++)this.linesBuffer[4*r+0]=e[r].from.x,this.linesBuffer[4*r+1]=e[r].from.y,this.linesBuffer[4*r+2]=e[r].to.x,this.linesBuffer[4*r+3]=e[r].to.y;this.linesVBO.setData(new Float32Array(this.linesBuffer)),this.linesShader.a.aCoords.VBO=this.linesVBO,this.linesShader.u.uScreenSize.value=[this._size.width,this._size.height],this.linesShader.u.uColor.value=[t.r/255,t.g/255,t.b/255,1],this.linesShader.use(),this.linesShader.bindUniformsAndAttributes(),l.gl.drawArrays(l.gl.LINES,0,2*i)}},t.prototype.drawPrimitives=function(e,t,i,n,r){this.updateStateAndColorVBOs(i,r),g.timeSpentInDrawDrawX.start(),this.useInstancing&&null!==t?this.drawInstanced(t,i,n):this.drawAsPoints(e,i),g.timeSpentInDrawDrawX.stop()},t.prototype.drawInstanced=function(e,t,i){var n=t.length;this.supportsInstancing&&null!==e&&n>0&&(e.u.uScreenSize.value=[this._size.width,this._size.height],e.use(),e.bindUniforms(),this.geometryVBO.bind(e.a.aVertex.loc),this.statesVBO.bindInstanced(e.a.aState.loc,this.instancingExt,1),this.colorsVBO.bindInstanced(e.a.aColor.loc,this.instancingExt,1),this.needToResetInstancingDivision=!0,i===h.EPrimitive.TRIANGLE?this.instancingExt.drawArraysInstancedANGLE(l.gl.TRIANGLES,4,3,n):this.instancingExt.drawArraysInstancedANGLE(l.gl.TRIANGLE_STRIP,0,4,n))},t.prototype.drawAsPoints=function(e,t){var i=t.length;null!==e&&i>0&&(e.a.aState.VBO=this.statesVBO,e.a.aColor.VBO=this.colorsVBO,e.u.uScreenSize.value=[this._size.width,this._size.height],e.use(),this.needToResetInstancingDivision&&(this.statesVBO.bindInstanced(e.a.aState.loc,this.instancingExt,0),this.colorsVBO.bindInstanced(e.a.aColor.loc,this.instancingExt,0),this.needToResetInstancingDivision=!1),e.bindUniformsAndAttributes(),l.gl.drawArrays(l.gl.POINTS,0,i))},t.prototype.updateStateAndColorVBOs=function(e,t){var i=e.length;g.timeSpentInDrawAllocateBuffer.start();var n=1024*Math.ceil(i/1024),r=4*n;this.statesBuffer.length!==r&&(this.statesBuffer=new Float32Array(r));var o=4*n;this.colorsBuffer.length!==o&&(this.colorsBuffer=new Float32Array(o)),g.timeSpentInDrawAllocateBuffer.stop(),this.enableBlending=h.Parameters.blending;var s=performance.now(),a=d.PatternBase.maxBlendingTime;"function"!=typeof t&&(t=function(){return 0}),g.timeSpentInDrawFillBuffer.start();for(var l=0;l<i;l++){var c=e[l].color;this.statesBuffer[4*l+0]=e[l].center.x,this.statesBuffer[4*l+1]=e[l].center.y,this.statesBuffer[4*l+2]=e[l].size,this.statesBuffer[4*l+3]=t(e[l]),this.colorsBuffer[4*l+0]=c.r/255,this.colorsBuffer[4*l+1]=c.g/255,this.colorsBuffer[4*l+2]=c.b/255,this.colorsBuffer[4*l+3]=e[l].computeOpacity(s,a)}g.timeSpentInDrawFillBuffer.stop(),g.timeSpentInDrawUploadVBO.start(),this.statesVBO.setData(this.statesBuffer),this.colorsVBO.setData(this.colorsBuffer),g.timeSpentInDrawUploadVBO.stop()},Object.defineProperty(t.prototype,"enableBlending",{set:function(e){e!==this.blending&&(this.blending=e,e?(l.gl.enable(l.gl.BLEND),l.gl.blendFunc(l.gl.SRC_ALPHA,l.gl.ONE_MINUS_SRC_ALPHA)):l.gl.disable(l.gl.BLEND))},enumerable:!1,configurable:!0}),t.prototype.loadAndBuildShader=function(e,t,i,n){c.buildShader({vertexFilename:e,fragmentFilename:t,injected:{}},(function(e){if(null===e){var t="Failed to load or build the "+i+" shader.";throw Page.Demopage.setErrorMessage("shader-"+i,t),new Error(t)}n(e)}))},Object.defineProperty(t.prototype,"supportsInstancing",{get:function(){return null!==this.instancingExt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useInstancing",{get:function(){return this.supportsInstancing&&h.Parameters.useInstancing},enumerable:!1,configurable:!0}),t}(p.PlotterCanvasBase);t.PlotterCanvasWebGL=P},174:function(e,t,i){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.PlotterSVG=void 0;var o=function(e){function t(t){var i=e.call(this)||this;return i._size={width:t.width,height:t.height},i}return r(t,e),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isReady",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){this.stringParts=[],this.stringParts.push('<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n'),this.stringParts.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 '+this._size.width+" "+this._size.height+'">\n'),this.stringParts.push('\t<rect fill="'+e+'" stroke="none" x="0" y="0" width="'+this._size.width+'" height="'+this._size.height+'"/>\n')},t.prototype.finalize=function(){this.stringParts.push("</svg>\n")},t.prototype.drawSquares=function(e){var t=.5*this._size.width,i=.5*this._size.height;this.stringParts.push('\t<g stroke="none">\n');for(var n=0,r=e;n<r.length;n++){var o=r[n],s=o.center.x+t,a=o.center.y+i,l=.5*o.size;this.stringParts.push('\t\t<rect fill="'+o.color+'" x="'+(s-l)+'" y="'+(a-l)+'" width="'+o.size+'" height="'+o.size+'"/>\n')}this.stringParts.push("\t</g>\n")},t.prototype.drawCircles=function(e){var t=.5*this._size.width,i=.5*this._size.height;this.stringParts.push('\t<g stroke="none">\n');for(var n=0,r=e;n<r.length;n++){var o=r[n],s=o.center.x+t,a=o.center.y+i;this.stringParts.push('\t\t<circle fill="'+o.color+'" cx="'+s+'" cy="'+a+'" r="'+o.radius+'"/>\n')}this.stringParts.push("\t</g>\n")},t.prototype.drawRectangles=function(e){var t=.5*this._size.width,i=.5*this._size.height;this.stringParts.push('\t<g stroke="none">\n');for(var n=0,r=e;n<r.length;n++){var o=r[n],s=o.center.x+t,a=o.center.y+i;this.stringParts.push('\t\t<rect fill="'+o.color+'" x="'+(s-.5*o.width)+'" y="'+(a-.5*o.height)+'" width="'+o.width+'" height="'+o.height+'"/>\n')}this.stringParts.push("\t</g>\n")},t.prototype.drawTriangles=function(e){var t=.5*this._size.width,i=.5*this._size.height;this.stringParts.push('\t<g stroke="none">\n');for(var n=0,r=e;n<r.length;n++){var o=r[n],s=o.center.x+t,a=o.center.y+i;this.stringParts.push('\t\t<polygon fill="'+o.color+'" points="'+(s+o.P1.x*o.size)+","+(a+o.P1.y*o.size)+" "+(s+o.P2.x*o.size)+","+(a+o.P2.y*o.size)+" "+(s+o.P3.x*o.size)+","+(a+o.P3.y*o.size)+'"/>\n')}this.stringParts.push("\t</g>\n")},t.prototype.drawLines=function(e,t){for(var i=[],n=.5*this._size.width,r=.5*this._size.height,o=0,s=e;o<s.length;o++){var a=s[o],l=a.from.x+n,c=a.from.y+r,u=a.to.x+n,h=a.to.y+r;i.push("M"+l+","+c+"L"+u+","+h)}this.stringParts.push('\t\t\t<path fill="none" stroke-width="1" stroke="'+t+'" d="'+i.join()+'"/>\n')},t.prototype.export=function(){return this.stringParts.join("")},t}(i(792).PlotterBase);t.PlotterSVG=o},247:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Grid=void 0;var s=o(i(8)),a=i(697),l=function(){function e(){this.gridSize={width:0,height:0},this.gridCells=[],this.topLeftCorner={x:0,y:0},this.reset({width:1,height:1},100,[])}return e.prototype.reset=function(e,t,i){this.registeredItemsCount=0,s.timeSpentInReindexResetDomain.start();var n=this.resetDomain(e,t);s.timeSpentInReindexResetDomain.stop(),s.timeSpentInReindexReindexItems.start();for(var r=0,o=i;r<o.length;r++){var a=o[r];this.registerItem(a)}return s.timeSpentInReindexReindexItems.stop(),n},e.prototype.registerItem=function(e){for(var t={x:e.center.x-.5*e.size,y:e.center.y-.5*e.size},i={x:e.center.x+.5*e.size,y:e.center.y+.5*e.size},n=this.getCellId(t),r=this.getCellId(i),o=n.y;o<=r.y;o++)for(var s=n.x;s<=r.x;s++){var a=this.computeCellId(s,o);this.gridCells[a].push(e),this.registeredItemsCount++}},e.prototype.draw=function(e){for(var t=[],i=this.topLeftCorner.x,n=i+this.gridSize.width*this._cellSize,r=this.topLeftCorner.y,o=r+this.gridSize.height*this._cellSize,s=0;s<this.gridSize.width;s++){var l=i+s*this._cellSize,c={from:{x:l,y:r},to:{x:l,y:o}};t.push(c)}for(var u=0;u<this.gridSize.height;u++){var h=r+u*this._cellSize;c={from:{x:i,y:h},to:{x:n,y:h}},t.push(c)}e.drawLines(t,a.Color.GREEN)},e.prototype.getCellId=function(e){var t=Math.floor((e.x-this.topLeftCorner.x)/this._cellSize),i=Math.floor((e.y-this.topLeftCorner.y)/this._cellSize);return t<0?t=0:t>=this.gridSize.width&&(t=this.gridSize.width-1),i<0?i=0:i>=this.gridSize.height&&(i=this.gridSize.height-1),{x:t,y:i}},e.prototype.getDistanceToClosestBorder=function(e){var t=(e.x-this.topLeftCorner.x)%this._cellSize,i=(e.y-this.topLeftCorner.y)%this._cellSize,n=Math.min(t,this._cellSize-t),r=Math.min(i,this._cellSize-i);return Math.min(n,r)},e.prototype.getItemsFromCell=function(e,t){if(e>=0&&e<this.gridSize.width&&t>=0&&t<this.gridSize.height){var i=this.computeCellId(e,t);return this.gridCells[i]}return[]},e.prototype.getItemsFromCellsGroup=function(e,t,i,n){for(var r=[],o=t;o<=n;o++)for(var s=e;s<=i;s++){var a=this.getItemsFromCell(s,o);r.push.apply(r,a)}return r},e.prototype.computeStatistics=function(){s.registerGridStats(this.gridSize,this._cellSize,this.registeredItemsCount)},Object.defineProperty(e.prototype,"itemsPerCell",{get:function(){return 0===this.gridCells.length?0:this.registeredItemsCount/this.gridCells.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellSize",{get:function(){return this._cellSize},enumerable:!1,configurable:!0}),e.prototype.resetDomain=function(e,t){var i=Math.ceil(e.width/t),n=Math.ceil(e.height/t);t<10?t=10:t>500&&(t=500);var r=this._cellSize!==t||this.gridSize.width!==i||this.gridSize.height!==n;this._cellSize=t,this.gridSize.width=i,this.gridSize.height=n,this.topLeftCorner.x=-.5*e.width,this.topLeftCorner.y=-.5*e.height;var o=this.gridSize.width*this.gridSize.height;this.gridCells.length=o;for(var s=0;s<o;s++)this.gridCells[s]=[];return r},e.prototype.computeCellId=function(e,t){return e+t*this.gridSize.width},e}();t.Grid=l},8:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.timeSpentInZoom=t.timeSpentInRecycle=t.timeSpentInReindexReindexItems=t.timeSpentInReindexResetDomain=t.timeSpentInReindex=t.timeSpentInUpdate=t.timeSpentInDrawDrawX=t.timeSpentInDrawUploadVBO=t.timeSpentInDrawFillBuffer=t.timeSpentInDrawAllocateBuffer=t.timeSpentInDraw=t.timeSpentInMainLoop=t.registerRecyclingStats=t.registerFrame=t.registerGridStats=t.initialize=void 0;var n=i(61),r=i(935);i(457);var o=new r.StopWatch,s=0,a=new r.StopWatch;t.timeSpentInMainLoop=a;var l=new r.StopWatch;t.timeSpentInDraw=l;var c=new r.StopWatch;t.timeSpentInDrawAllocateBuffer=c;var u=new r.StopWatch;t.timeSpentInDrawFillBuffer=u;var h=new r.StopWatch;t.timeSpentInDrawUploadVBO=h;var d=new r.StopWatch;t.timeSpentInDrawDrawX=d;var f=new r.StopWatch;t.timeSpentInUpdate=f;var g=new r.StopWatch;t.timeSpentInReindex=g;var p=new r.StopWatch;t.timeSpentInReindexResetDomain=p;var m=new r.StopWatch;t.timeSpentInReindexReindexItems=m;var v=new r.StopWatch;t.timeSpentInRecycle=v;var P=new r.StopWatch;t.timeSpentInZoom=P;var b=0,y=0,_=0,x=0,C=0,I=0,S=0,w=0,O=0;t.initialize=function(){o.reset(),o.start(),s=0},t.registerFrame=function(){s++,o.totalTime>1e3&&(function(){var e=1e3*s/o.totalTime,t=o.totalTime/s,i=a.totalTime/s,r=i/t,z=l.totalTime/s,T=z/i,E=c.totalTime/s,A=E/z,R=u.totalTime/s,B=R/z,L=h.totalTime/s,M=L/z,V=d.totalTime/s,j=V/z,F=f.totalTime/s,k=F/i,D=g.totalTime/s,G=D/F,U=p.totalTime/s,W=U/D,N=m.totalTime/s,q=N/D,Z=v.totalTime/s,Y=Z/F,X=P.totalTime/s,H=X/F;if(n.Parameters.isInDebug){if(Page.Canvas.setIndicatorText("fps",e.toFixed(0)+" ("+t.toFixed(2)+" ms)"),Page.Canvas.setIndicatorText("main-loop-time",i.toFixed(2)+" ms ("+(100*r).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("draw-time",z.toFixed(2)+" ms ("+(100*T).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("draw-allocatebuffer-time",E.toFixed(2)+" ms ("+(100*A).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("draw-fillbuffer-time",R.toFixed(2)+" ms ("+(100*B).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("draw-uploadvbo-time",L.toFixed(2)+" ms ("+(100*M).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("draw-drawX-time",V.toFixed(2)+" ms ("+(100*j).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("update-time",F.toFixed(2)+" ms ("+(100*k).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("update-reindex-time",D.toFixed(2)+" ms ("+(100*G).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("update-reindex-resetdomain-time",U.toFixed(2)+" ms ("+(100*W).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("update-reindex-reindexitems-time",N.toFixed(2)+" ms ("+(100*q).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("update-recycle-time",Z.toFixed(2)+" ms ("+(100*Y).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("update-zoom-time",X.toFixed(2)+" ms ("+(100*H).toFixed(1)+" %)"),Page.Canvas.setIndicatorText("items-reclycled-count",""+(y/s*e).toFixed(1)),Page.Canvas.setIndicatorText("items-pending-recycling-count",""+(_/s).toFixed(1)),Page.Canvas.setIndicatorText("items-recycling-tries-count",""+(x/s).toFixed(1)),C>0){var Q=Math.round(I/C),K=Math.round(S/C),J=Q*K;Page.Canvas.setIndicatorText("grid-size",Q+"x"+K+" ("+J+")"),Page.Canvas.setIndicatorText("grid-cell-size",""+(w/C).toFixed(1)),Page.Canvas.setIndicatorText("grid-items-per-cell",""+(O/C/J).toFixed(1))}}else Page.Canvas.setIndicatorText("fps",e.toFixed(0));Page.Canvas.setIndicatorText("items-count",""+b),Page.Canvas.setIndicatorText("items-visible-count",""+(b-_/s).toFixed(0))}(),o.reset(),s=0,a.reset(),l.reset(),c.reset(),u.reset(),h.reset(),d.reset(),f.reset(),g.reset(),p.reset(),m.reset(),v.reset(),P.reset(),y=0,_=0,x=0,C=0)},t.registerRecyclingStats=function(e,t,i,n){b=e,y+=t,_+=i,x+=n},t.registerGridStats=function(e,t,i){0===C&&(I=0,S=0,w=0,O=0),C++,I+=e.width,S+=e.height,w+=t,O+=i}},935:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StopWatch=void 0;var i=function(){function e(){this._totalTime=0,this._isRunning=!1}return e.prototype.start=function(){this._isRunning?console.log("Error: stopwatch is already started"):(this._lastCheckpoint=performance.now(),this._isRunning=!0)},e.prototype.stop=function(){if(this._isRunning){var e=performance.now();this._totalTime+=e-this._lastCheckpoint,this._lastCheckpoint=e,this._isRunning=!1}else console.log("Error: stopwatch is already stopped.")},e.prototype.reset=function(){this._totalTime=0,this._lastCheckpoint=performance.now()},Object.defineProperty(e.prototype,"totalTime",{get:function(){return this._isRunning?this._totalTime+(performance.now()-this._lastCheckpoint):this._totalTime},enumerable:!1,configurable:!0}),e}();t.StopWatch=i},440:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryStringValue=t.downloadTextFile=void 0,t.downloadTextFile=function(e,t){var i="text/plain",n=new Blob([t],{type:i});if(void 0!==window.navigator&&void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,e);else{var r=URL.createObjectURL(n),o=document.createElement("a");o.download=e,o.href=r,o.dataset.downloadurl=i+":"+o.download+":"+o.href,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout((function(){URL.revokeObjectURL(r)}),5e3)}},t.getQueryStringValue=function(e){var t=window.location.href,i=t.indexOf("?");if(i>=0){var n=t.substring(i+1);if(n.length>0)for(var r=0,o=n.split("&");r<o.length;r++){var s=o[r].split("=");if(2===s.length&&decodeURIComponent(s[0])===e)return decodeURIComponent(s[1])}}return null}},587:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NumberRange=void 0;var i=function(){function e(e,t){this.from=e,this.to=t}return e.prototype.isInRange=function(e){return this.from<=e&&e<=this.to},e}();t.NumberRange=i}},t={};!function i(n){if(t[n])return t[n].exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,i),r.exports}(633)}();
//# sourceMappingURL=main.min.js.map